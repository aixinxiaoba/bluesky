!function(a){"use strict";function b(a){if(!a)throw new Error("请传入完整的url参数");this.url=a}b.prototype={constructor:b,ratio:50,getPerformance:function(){return a.performance?a.performance:a.webkitPerformance?a.webkitPerformance:a.msPerformance?a.msPerformance:a.mozPerformance?a.mozPerformance:null},getEntries:function(a){return a.getEntriesByType("resource")},getSampling:function(a){return a.sort(this.compare)[0]},keys:function(a){for(var b=[];a!==Object.prototype;)b=b.concat(Object.keys(a)),a=Object.getPrototypeOf(a);return b},purify:function(a){var b=this.keys(a),c=0,d={};return a.fetchStart>1436544e6&&(c=a.fetchStart),b.forEach(function(b){var e=a[b];"number"==typeof e&&(e>=c&&(e-=c),e=Math.ceil(e)),"function"!=typeof e&&(d[b]=e)}),d},stringify:function(a){return JSON.stringify(this.purify(a))},compare:function(a,b){return b.duration-a.duration},param:function(a,b,c){return a+=a.indexOf("?")>=0?"&":"?",a+=encodeURIComponent(b)+"="+encodeURIComponent(this.stringify(c))},isLucky:function(){return Math.ceil(100*Math.random())<=this.ratio},log:function(){var b,c,d,e,f;this.isLucky()&&(b=this.getPerformance(),b&&(f=this.url,f=this.param(f,"t",b.timing),c=this.getEntries(b),d=this.getSampling(c),d&&(f=this.param(f,"p",d)),a.navigator.sendBeacon?a.navigator.sendBeacon(f):(e=new a.Image,e.src=f)))}},a.addEventListener&&a.addEventListener("load",function(){var a="http://feperf.dayin.com/static";new b(a).log()})}(this);
